# üöÄ –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç PostgreSQL SQL Analyzer

## ‚úÖ **–ò–°–ü–†–ê–í–õ–ï–ù–û**: SSH —Ç—É–Ω–Ω–µ–ª—å —Ç–µ–ø–µ—Ä—å —Å–æ–∑–¥–∞–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏!

## üìã –ü—Ä–∞–≤–∏–ª—å–Ω—ã–π –ø–æ—Ä—è–¥–æ–∫ –∑–∞–ø—É—Å–∫–∞

### 1. üîß –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –æ–∫—Ä—É–∂–µ–Ω–∏—è

```bash
# –ü–µ—Ä–µ–π—Ç–∏ –≤ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é –ø—Ä–æ–µ–∫—Ç–∞
cd /home/dimk/postgres-sql-analyzer

# –ê–∫—Ç–∏–≤–∏—Ä–æ–≤–∞—Ç—å –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–µ –æ–∫—Ä—É–∂–µ–Ω–∏–µ
source venv/bin/activate
```

### 2. üîê SSH —Ç—É–Ω–Ω–µ–ª—å (–∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏)

**‚úÖ SSH —Ç—É–Ω–Ω–µ–ª—å —Å–æ–∑–¥–∞–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ–º!**

- –°–µ—Ä–≤–µ—Ä: `193.246.150.18`
- –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å: `skripka`
- –õ–æ–∫–∞–ª—å–Ω—ã–π –ø–æ—Ä—Ç: `5433`
- –£–¥–∞–ª–µ–Ω–Ω—ã–π –ø–æ—Ä—Ç: `5433`

**–†—É—á–Ω–æ–µ —Å–æ–∑–¥–∞–Ω–∏–µ (—Ç–æ–ª—å–∫–æ –¥–ª—è –æ—Ç–ª–∞–¥–∫–∏):**
```bash
ssh -N -L 5433:localhost:5433 -i ~/.ssh/id_rsa skripka@193.246.150.18 &
```

### 3. üöÄ –ó–∞–ø—É—Å–∫ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è

```bash
# –ó–∞–ø—É—Å—Ç–∏—Ç—å Streamlit –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ
python scripts/run_streamlit.py
```

### 4. üåê –û—Ç–∫—Ä—ã—Ç—å –±—Ä–∞—É–∑–µ—Ä

–ü–µ—Ä–µ–π—Ç–∏ –ø–æ –∞–¥—Ä–µ—Å—É: **http://localhost:8505**

---

## ‚öôÔ∏è –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –≤ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–µ

### ü§ñ **–ù–∞—Å—Ç—Ä–æ–π–∫–∏ AI (–ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω—ã)**
- ‚úÖ **OpenAI API Key**: –ù–∞—Å—Ç—Ä–æ–µ–Ω
- ‚úÖ **–ú–æ–¥–µ–ª—å**: `gpt-4o-mini` (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ–º–∞—è)
- ‚úÖ **–¢–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞**: `0.7`
- ‚úÖ **AI —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏**: –í–∫–ª—é—á–µ–Ω—ã
- ‚úÖ **–ü—Ä–æ–≤–∞–π–¥–µ—Ä**: `openai`

### –í –±–æ–∫–æ–≤–æ–π –ø–∞–Ω–µ–ª–∏:

1. **–¢–∏–ø –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è**: –í—ã–±–µ—Ä–∏—Ç–µ "SSH —Ç—É–Ω–Ω–µ–ª—å"
2. **SSH —Ö–æ—Å—Ç**: `193.246.150.18` (—É–∂–µ –∑–∞–ø–æ–ª–Ω–µ–Ω–æ)
3. **SSH –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å**: `skripka` (—É–∂–µ –∑–∞–ø–æ–ª–Ω–µ–Ω–æ)
4. **SSH –∫–ª—é—á**: `~/.ssh/id_rsa` (—É–∂–µ –∑–∞–ø–æ–ª–Ω–µ–Ω–æ)
5. **–•–æ—Å—Ç –ë–î**: `localhost` (–¥–ª—è SSH —Ç—É–Ω–Ω–µ–ª—è)
6. **–ü–æ—Ä—Ç –ë–î**: `5433`
7. **–ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö**: `postgres`
8. **–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å**: `readonly_user`
9. **–ù–∞—Å—Ç—Ä–æ–π–∫–∏ PostgreSQL**: work_mem, shared_buffers, effective_cache_size

### –ù–∞–∂–º–∏—Ç–µ "üîå –ü–æ–¥–∫–ª—é—á–∏—Ç—å—Å—è –∫ –ë–î"
- –ö–Ω–æ–ø–∫–∞ –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –ø–æ—Å–ª–µ –Ω–∞—Å—Ç—Ä–æ–µ–∫ PostgreSQL
- –°—Ç–∞—Ç—É—Å –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è –ø–æ–¥ –∫–Ω–æ–ø–∫–æ–π
- üü¢ –ó–µ–ª–µ–Ω—ã–π = –ø–æ–¥–∫–ª—é—á–µ–Ω–æ, üî¥ –ö—Ä–∞—Å–Ω—ã–π = –Ω–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–æ

---

## üêõ –£—Å—Ç—Ä–∞–Ω–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º

### –ü—Ä–æ–±–ª–µ–º–∞: "Address already in use"

```bash
# –ù–∞–π—Ç–∏ –ø—Ä–æ—Ü–µ—Å—Å, –∏—Å–ø–æ–ª—å–∑—É—é—â–∏–π –ø–æ—Ä—Ç 5433
sudo lsof -i :5433

# –û—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –ø—Ä–æ—Ü–µ—Å—Å
sudo kill -9 <PID>

# –ò–ª–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –¥—Ä—É–≥–æ–π –ø–æ—Ä—Ç
ssh -N -L 5434:localhost:5433 -i ~/.ssh/id_rsa skripka@193.246.150.18 &
```

### –ü—Ä–æ–±–ª–µ–º–∞: "Permission denied (publickey)"

```bash
# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ø—Ä–∞–≤–∞ –Ω–∞ SSH –∫–ª—é—á
chmod 600 ~/.ssh/id_rsa
chmod 644 ~/.ssh/id_rsa.pub

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å SSH –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ
ssh -i ~/.ssh/id_rsa skripka@193.246.150.18 "echo 'SSH OK'"
```

### –ü—Ä–æ–±–ª–µ–º–∞: "Connection refused"

```bash
# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å —Å–µ—Ä–≤–µ—Ä–∞
ping 193.246.150.18

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å SSH –ø–æ—Ä—Ç
telnet 193.246.150.18 22
```

---

## üîÑ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –∑–∞–ø—É—Å–∫

### –°–∫—Ä–∏–ø—Ç –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ –∑–∞–ø—É—Å–∫–∞

–°–æ–∑–¥–∞–π—Ç–µ —Ñ–∞–π–ª `start_app.sh`:

```bash
#!/bin/bash
# start_app.sh

echo "üöÄ –ó–∞–ø—É—Å–∫ PostgreSQL SQL Analyzer..."

# –ê–∫—Ç–∏–≤–∏—Ä–æ–≤–∞—Ç—å –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–µ –æ–∫—Ä—É–∂–µ–Ω–∏–µ
source venv/bin/activate

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å SSH –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ
echo "üîê –ü—Ä–æ–≤–µ—Ä–∫–∞ SSH –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è..."
ssh -o ConnectTimeout=5 -i ~/.ssh/id_rsa skripka@193.246.150.18 "echo 'SSH OK'" || {
    echo "‚ùå SSH –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –Ω–µ —É–¥–∞–ª–æ—Å—å"
    exit 1
}

# –û—Å—Ç–∞–Ω–æ–≤–∏—Ç—å —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ SSH —Ç—É–Ω–Ω–µ–ª–∏
echo "üîÑ –û—Å—Ç–∞–Ω–æ–≤–∫–∞ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏—Ö —Ç—É–Ω–Ω–µ–ª–µ–π..."
pkill -f "ssh.*5433.*skripka@193.246.150.18" 2>/dev/null || true

# –ó–∞–ø—É—Å—Ç–∏—Ç—å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ
echo "üöÄ –ó–∞–ø—É—Å–∫ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è..."
python scripts/run_streamlit.py
```

–°–¥–µ–ª–∞—Ç—å –∏—Å–ø–æ–ª–Ω—è–µ–º—ã–º:
```bash
chmod +x start_app.sh
```

–ó–∞–ø—É—Å–∫:
```bash
./start_app.sh
```

---

## üìä –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–æ—Å—Ç–æ—è–Ω–∏—è

### –ü—Ä–æ–≤–µ—Ä–∏—Ç—å SSH —Ç—É–Ω–Ω–µ–ª—å:
```bash
ps aux | grep "ssh.*5433" | grep -v grep
```

### –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ –ë–î:
```bash
psql -h localhost -p 5433 -U readonly_user -d postgres -c "SELECT 1;"
```

### –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ø–æ—Ä—Ç—ã:
```bash
netstat -tlnp | grep -E ":(5433|8505)"
```

---

## üéØ –†–µ–∫–æ–º–µ–Ω–¥—É–µ–º—ã–π –ø–æ—Ä—è–¥–æ–∫

1. **–ê–∫—Ç–∏–≤–∏—Ä–æ–≤–∞—Ç—å venv**: `source venv/bin/activate`
2. **–ó–∞–ø—É—Å—Ç–∏—Ç—å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ**: `python scripts/run_streamlit.py`
3. **–û—Ç–∫—Ä—ã—Ç—å –±—Ä–∞—É–∑–µ—Ä**: http://localhost:8505
4. **–í—ã–±—Ä–∞—Ç—å SSH —Ç—É–Ω–Ω–µ–ª—å** –≤ –±–æ–∫–æ–≤–æ–π –ø–∞–Ω–µ–ª–∏
5. **–ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ** –∫–Ω–æ–ø–∫–æ–π "üîå –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ"

**SSH —Ç—É–Ω–Ω–µ–ª—å —Å–æ–∑–¥–∞–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ–º!** üéâ
