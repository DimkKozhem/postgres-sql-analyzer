# üîê –ù–∞—Å—Ç—Ä–æ–π–∫–∞ SSH –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ —Å–µ—Ä–≤–µ—Ä—É

–≠—Ç–æ —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ–º–æ–∂–µ—Ç –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å SSH –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ —Å–µ—Ä–≤–µ—Ä—É `193.246.150.18` –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å PostgreSQL SQL Analyzer.

## üéØ –¶–µ–ª—å

–ù–∞—Å—Ç—Ä–æ–∏—Ç—å –±–µ–∑–æ–ø–∞—Å–Ω–æ–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö PostgreSQL —á–µ—Ä–µ–∑ SSH —Ç—É–Ω–Ω–µ–ª—å:
```bash
ssh -v -i ~/.ssh/id_rsa skripka@193.246.150.18
```

## üìã –ü—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω—ã–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è

- SSH –∫–ª—é—á –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è `skripka`
- –î–æ—Å—Ç—É–ø –∫ —Å–µ—Ä–≤–µ—Ä—É `193.246.150.18`
- PostgreSQL –Ω–∞ —É–¥–∞–ª–µ–Ω–Ω–æ–º —Å–µ—Ä–≤–µ—Ä–µ

## üîë –ù–∞—Å—Ç—Ä–æ–π–∫–∞ SSH –∫–ª—é—á–µ–π

### 1. –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏—Ö –∫–ª—é—á–µ–π
```bash
ls -la ~/.ssh/
```

### 2. –°–æ–∑–¥–∞–Ω–∏–µ –Ω–æ–≤–æ–≥–æ SSH –∫–ª—é—á–∞ (–µ—Å–ª–∏ –Ω—É–∂–Ω–æ)
```bash
ssh-keygen -t rsa -b 4096 -C "your-email@example.com"
```

### 3. –ö–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—É–±–ª–∏—á–Ω–æ–≥–æ –∫–ª—é—á–∞ –Ω–∞ —Å–µ—Ä–≤–µ—Ä
```bash
ssh-copy-id -i ~/.ssh/id_rsa.pub skripka@193.246.150.18
```

### 4. –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ SSH –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è
```bash
ssh -v -i ~/.ssh/id_rsa skripka@193.246.150.18
```

## ‚öôÔ∏è –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è

### 1. –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ .env —Ñ–∞–π–ª–∞
```bash
# SSH –Ω–∞—Å—Ç—Ä–æ–π–∫–∏
SQL_ANALYZER_SSH_HOST=193.246.150.18
SQL_ANALYZER_SSH_PORT=22
SQL_ANALYZER_SSH_USER=skripka
SQL_ANALYZER_SSH_KEY_PATH=~/.ssh/id_rsa
SQL_ANALYZER_AUTO_CREATE_SSH_TUNNEL=true
SQL_ANALYZER_SSH_TIMEOUT=30

# –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö
SQL_ANALYZER_DB_HOST=localhost
SQL_ANALYZER_DB_PORT=5433
SQL_ANALYZER_DB_NAME=postgres
SQL_ANALYZER_DB_USER=readonly_user
SQL_ANALYZER_DB_PASSWORD=skripka_user
```

### 2. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –≤ Streamlit –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–µ

–í –±–æ–∫–æ–≤–æ–π –ø–∞–Ω–µ–ª–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è:

1. **–¢–∏–ø –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è**: –í—ã–±–µ—Ä–∏—Ç–µ "SSH —Ç—É–Ω–Ω–µ–ª—å"
2. **SSH —Ö–æ—Å—Ç**: `193.246.150.18`
3. **SSH –ø–æ—Ä—Ç**: `22`
4. **SSH –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å**: `skripka`
5. **–ü—É—Ç—å –∫ SSH –∫–ª—é—á—É**: `~/.ssh/id_rsa`
6. **–•–æ—Å—Ç –ë–î**: `localhost` (–¥–ª—è SSH —Ç—É–Ω–Ω–µ–ª—è)
7. **–ü–æ—Ä—Ç –ë–î**: `5433`
8. **–ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö**: `postgres`
9. **–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å**: `readonly_user`

## üîß –ü—Ä–∏–Ω—Ü–∏–ø —Ä–∞–±–æ—Ç—ã

### SSH —Ç—É–Ω–Ω–µ–ª–∏—Ä–æ–≤–∞–Ω–∏–µ
```
–õ–æ–∫–∞–ª—å–Ω–∞—è –º–∞—à–∏–Ω–∞ ‚Üí SSH —Ç—É–Ω–Ω–µ–ª—å ‚Üí –°–µ—Ä–≤–µ—Ä 193.246.150.18 ‚Üí PostgreSQL
     :5433              :22              localhost:5432
```

### –ö–æ–º–∞–Ω–¥–∞ SSH —Ç—É–Ω–Ω–µ–ª—è
```bash
ssh -N -L 5433:localhost:5432 -i ~/.ssh/id_rsa skripka@193.246.150.18
```

–ì–¥–µ:
- `-N`: –ù–µ –≤—ã–ø–æ–ª–Ω—è—Ç—å —É–¥–∞–ª–µ–Ω–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã
- `-L 5433:localhost:5432`: –õ–æ–∫–∞–ª—å–Ω—ã–π –ø–æ—Ä—Ç 5433 ‚Üí —É–¥–∞–ª–µ–Ω–Ω—ã–π localhost:5432
- `-i ~/.ssh/id_rsa`: –ü—É—Ç—å –∫ –ø—Ä–∏–≤–∞—Ç–Ω–æ–º—É –∫–ª—é—á—É
- `skripka@193.246.150.18`: –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –∏ —Ö–æ—Å—Ç

## üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è

### 1. –¢–µ—Å—Ç SSH –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è
```bash
ssh -o ConnectTimeout=10 -i ~/.ssh/id_rsa skripka@193.246.150.18 "echo 'SSH connection successful'"
```

### 2. –¢–µ—Å—Ç SSH —Ç—É–Ω–Ω–µ–ª—è
```bash
# –í –æ–¥–Ω–æ–º —Ç–µ—Ä–º–∏–Ω–∞–ª–µ —Å–æ–∑–¥–∞–µ–º —Ç—É–Ω–Ω–µ–ª—å
ssh -N -L 5433:localhost:5432 -i ~/.ssh/id_rsa skripka@193.246.150.18

# –í –¥—Ä—É–≥–æ–º —Ç–µ—Ä–º–∏–Ω–∞–ª–µ —Ç–µ—Å—Ç–∏—Ä—É–µ–º –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ –ë–î
psql -h localhost -p 5433 -U readonly_user -d postgres
```

### 3. –¢–µ—Å—Ç —á–µ—Ä–µ–∑ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ
1. –ó–∞–ø—É—Å—Ç–∏—Ç–µ PostgreSQL SQL Analyzer
2. –í –±–æ–∫–æ–≤–æ–π –ø–∞–Ω–µ–ª–∏ –≤—ã–±–µ—Ä–∏—Ç–µ "SSH —Ç—É–Ω–Ω–µ–ª—å"
3. –ù–∞–∂–º–∏—Ç–µ "üîå –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ"

## üêõ –£—Å—Ç—Ä–∞–Ω–µ–Ω–∏–µ –Ω–µ–ø–æ–ª–∞–¥–æ–∫

### –ü—Ä–æ–±–ª–µ–º–∞: "Permission denied (publickey)"
```bash
# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø—Ä–∞–≤–∞ –Ω–∞ SSH –∫–ª—é—á
chmod 600 ~/.ssh/id_rsa
chmod 644 ~/.ssh/id_rsa.pub

# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ –ø—É–±–ª–∏—á–Ω—ã–π –∫–ª—é—á –¥–æ–±–∞–≤–ª–µ–Ω –Ω–∞ —Å–µ—Ä–≤–µ—Ä
ssh -i ~/.ssh/id_rsa skripka@193.246.150.18
```

### –ü—Ä–æ–±–ª–µ–º–∞: "Connection refused"
```bash
# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å —Å–µ—Ä–≤–µ—Ä–∞
ping 193.246.150.18

# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ SSH –ø–æ—Ä—Ç
telnet 193.246.150.18 22
```

### –ü—Ä–æ–±–ª–µ–º–∞: "Port already in use"
```bash
# –ù–∞–π–¥–∏—Ç–µ –ø—Ä–æ—Ü–µ—Å—Å, –∏—Å–ø–æ–ª—å–∑—É—é—â–∏–π –ø–æ—Ä—Ç 5433
lsof -i :5433

# –£–±–µ–π—Ç–µ –ø—Ä–æ—Ü–µ—Å—Å –∏–ª–∏ –∏–∑–º–µ–Ω–∏—Ç–µ –ø–æ—Ä—Ç –≤ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞—Ö
kill -9 <PID>
```

### –ü—Ä–æ–±–ª–µ–º–∞: "Database connection failed"
```bash
# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ PostgreSQL –∑–∞–ø—É—â–µ–Ω –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ
ssh -i ~/.ssh/id_rsa skripka@193.246.150.18 "sudo systemctl status postgresql"

# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ PostgreSQL
ssh -i ~/.ssh/id_rsa skripka@193.246.150.18 "sudo -u postgres psql -c 'SHOW port;'"
```

## üîí –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

### –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏
1. **–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ SSH –∫–ª—é—á–∏** –≤–º–µ—Å—Ç–æ –ø–∞—Ä–æ–ª–µ–π
2. **–û–≥—Ä–∞–Ω–∏—á—å—Ç–µ –ø—Ä–∞–≤–∞** SSH –∫–ª—é—á–∞
3. **–†–µ–≥—É–ª—è—Ä–Ω–æ –æ–±–Ω–æ–≤–ª—è–π—Ç–µ** SSH –∫–ª—é—á–∏
4. **–ú–æ–Ω–∏—Ç–æ—Ä—å—Ç–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è** –∫ —Å–µ—Ä–≤–µ—Ä—É
5. **–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ firewall** –¥–ª—è –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è –¥–æ—Å—Ç—É–ø–∞

### –ù–∞—Å—Ç—Ä–æ–π–∫–∞ SSH –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
–°–æ–∑–¥–∞–π—Ç–µ —Ñ–∞–π–ª `~/.ssh/config`:
```
Host postgres-server
    HostName 193.246.150.18
    User skripka
    IdentityFile ~/.ssh/id_rsa
    Port 22
    ServerAliveInterval 60
    ServerAliveCountMax 3
```

–¢–µ–ø–µ—Ä—å –º–æ–∂–Ω–æ –ø–æ–¥–∫–ª—é—á–∞—Ç—å—Å—è –ø—Ä–æ—Å—Ç–æ:
```bash
ssh postgres-server
```

## üìä –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥

### –ü—Ä–æ–≤–µ—Ä–∫–∞ –∞–∫—Ç–∏–≤–Ω—ã—Ö SSH —Ç—É–Ω–Ω–µ–ª–µ–π
```bash
# –°–ø–∏—Å–æ–∫ –∞–∫—Ç–∏–≤–Ω—ã—Ö SSH —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–π
ps aux | grep ssh

# –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ—Ä—Ç–æ–≤
netstat -tlnp | grep :5433
```

### –õ–æ–≥–∏ SSH –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–π
```bash
# –õ–æ–≥–∏ SSH –Ω–∞ –∫–ª–∏–µ–Ω—Ç–µ
tail -f /var/log/auth.log

# –õ–æ–≥–∏ SSH –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ
ssh -i ~/.ssh/id_rsa skripka@193.246.150.18 "sudo tail -f /var/log/auth.log"
```

## üöÄ –ê–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è

### –°–∫—Ä–∏–ø—Ç –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è SSH —Ç—É–Ω–Ω–µ–ª—è
```bash
#!/bin/bash
# create_ssh_tunnel.sh

SSH_HOST="193.246.150.18"
SSH_USER="skripka"
SSH_KEY="~/.ssh/id_rsa"
LOCAL_PORT="5433"
REMOTE_PORT="5432"

echo "–°–æ–∑–¥–∞–Ω–∏–µ SSH —Ç—É–Ω–Ω–µ–ª—è..."
ssh -N -L ${LOCAL_PORT}:localhost:${REMOTE_PORT} -i ${SSH_KEY} ${SSH_USER}@${SSH_HOST} &
TUNNEL_PID=$!

echo "SSH —Ç—É–Ω–Ω–µ–ª—å —Å–æ–∑–¥–∞–Ω —Å PID: $TUNNEL_PID"
echo "–î–ª—è –æ—Å—Ç–∞–Ω–æ–≤–∫–∏ –≤—ã–ø–æ–ª–Ω–∏—Ç–µ: kill $TUNNEL_PID"
```

### –ê–≤—Ç–æ–∑–∞–ø—É—Å–∫ SSH —Ç—É–Ω–Ω–µ–ª—è
```bash
# –î–æ–±–∞–≤—å—Ç–µ –≤ crontab –¥–ª—è –∞–≤—Ç–æ–∑–∞–ø—É—Å–∫–∞
@reboot /path/to/create_ssh_tunnel.sh
```

## üìû –ü–æ–¥–¥–µ—Ä–∂–∫–∞

–ü—Ä–∏ –≤–æ–∑–Ω–∏–∫–Ω–æ–≤–µ–Ω–∏–∏ –ø—Ä–æ–±–ª–µ–º:

1. **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏** –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
2. **–£–±–µ–¥–∏—Ç–µ—Å—å –≤ –ø—Ä–∞–≤–∏–ª—å–Ω–æ—Å—Ç–∏** SSH –∫–ª—é—á–µ–π
3. **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å** —Å–µ—Ä–≤–µ—Ä–∞
4. **–û–±—Ä–∞—Ç–∏—Ç–µ—Å—å –∫ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä—É** —Å–µ—Ä–≤–µ—Ä–∞
5. **–°–æ–∑–¥–∞–π—Ç–µ issue** –≤ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–∏ –ø—Ä–æ–µ–∫—Ç–∞

---

**üéâ SSH –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω–æ! –¢–µ–ø–µ—Ä—å –≤—ã –º–æ–∂–µ—Ç–µ –±–µ–∑–æ–ø–∞—Å–Ω–æ —Ä–∞–±–æ—Ç–∞—Ç—å —Å –±–∞–∑–æ–π –¥–∞–Ω–Ω—ã—Ö —á–µ—Ä–µ–∑ —Ç—É–Ω–Ω–µ–ª—å.**